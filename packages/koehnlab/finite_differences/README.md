# finite\_differences

This sub-package implements functionality related to the method of approximating a derivative via
[finite difference](https://en.wikipedia.org/wiki/Finite_difference).


## Provided functions

### `forward_difference`

Approximates the first derivative of a function by means of forward difference.

| **Parameter** | **Description** | **Default** |
| ------------- | --------------- | ----------- |
| `values` | A sequence of exactly two function values | - |
| `delta`  | The spacing of the locations at which the function values have been sampled | - |

### `central_difference`

Approximates the first derivative of a function by means of central difference. Supports the 2-point and 4-point formula. In both cases, the provided
function values are expected to have been sampled on a uniformly spaced 1D grid. If the spacing of that grid is `d`, and the derivative shall be
approximated at `x`, the provided function values must be sampled at `[x - d, x + d]` or `[x - 2d, x - d, x + d, x + 2d]`.

| **Parameter** | **Description** | **Default** |
| ------------- | --------------- | ----------- |
| `values` | A sequence of exactly two or four function values (sampled as described above) | - |
| `delta`  | The spacing of the locations at which the function values have been sampled (`d` from above) | - |

### `generate_finite_difference_coefficients`

Generates the coefficients used in finite difference formulas that work with arbitrarily spaced grids and for derivatives of arbitrary order
(including order zero, which corresponds to interpolation rather than differentiation).
The coefficients are generated by the algorithm described in Fornberg, B. (1988). Math. Comp., 51(184), 699–706.

| **Parameter** | **Description** | **Default** |
| ------------- | --------------- | ----------- |
| `x0` | The location at which the derivative shall be calculated | - |
| `x_values` | A sequence of locations at which the function values will be sampled. This sequence must not contain duplicate entries. | - |
| `order` | The order of the derivative that the formula shall compute | `1` |

If the returned sequence of coefficients is understood as a vector, its scalar product with the vector of sampled function values (in the same order
as the provided `x_values` sequence suggests) will represent the desired approximate to the derivative.

### `approximate_derivative`

Approximates the derivative (arbitrary order) of a function by means of finite difference. The provided points may be sampled on an arbitrary grid.
Since this function needs to recompute the required coefficients on every call, you should prefer `forward_difference` and `central_difference`, if
those suffice your needs. 

| **Parameter** | **Description** | **Default** |
| ------------- | --------------- | ----------- |
| `points` | A sequence of tuples of exactly two numbers, representing a point in 2D space. | `None` |
| `x_values` | A sequence of locations | `None` |
| `y_values` | A sequence of function values that have been sampled at the locations given in `x_values` | `None` |
| `order` | The order of the derivative to approximate. Can be zero, in which case an interpolation instead of differentiation is performed | `1` |
| `x0` | The location the derivative shall be computed at | `0` |

The arguments `points` and the pair `x_values` and `y_values` is mutually exclusive, but one of them must be provided.



## References
- [Finite Difference Coefficients Calculator](https://web.media.mit.edu/~crtaylor/calculator.html)
- [Fornberg, B. (1988). Math. Comp., 51(184), 699–706.](https://doi.org/10.2307/2008770)
